/*
 * Author: Damian Schwyrz <mail@damianschwyrz.de>
 * URL: https://www.damianschwyrz.de
 * Copyright (c) 2018.
 */

$(function () {
    updateTspFrame();

    setInterval(function () {
        updateTspFrame();
    }, 4500);


    $(document).on('click', '#tsp-clear', function (event) {
        event.preventDefault();
        $.ajax({
            url: $(this).attr("href"),
            type: 'POST',
            complete: function (result) {
                console.log(result);
                updateTspFrame();
            }
        });
    });

    $(document).on('click','.deque-from-tsp',function(event) {
        event.preventDefault();
        $.ajax({
            url: $(this).attr("href"),
            type: 'DELETE',
            complete: function (result) {
                console.log(result);
                updateTspFrame();
            }
        });
    });
});

function updateTspFrame() {
    $("#tsp-update-spinner").removeClass("hidden");
    $.ajax({
        url: tsp_get_route,
        type: 'GET',
        success: function (result) {
            $("#task-spooler-out").html(result.output);
            $("#tsp-update-spinner").addClass("hidden");
        }
    });
}